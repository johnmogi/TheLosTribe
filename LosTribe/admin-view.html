<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LosTribe - Backstage Generator Admin View</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1, h2, h3 {
            color: #64b5f6;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(100, 181, 246, 0.5);
        }

        h1 {
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 2px solid #64b5f6;
            padding-bottom: 20px;
        }

        .run-summary {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #64b5f6;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .summary-card {
            background: rgba(100, 181, 246, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .summary-card h3 {
            color: #81c784;
            font-size: 2em;
            margin-bottom: 5px;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #64b5f6;
        }

        .tab-btn {
            background: none;
            border: none;
            color: #e0e0e0;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }

        .tab-btn:hover {
            background: rgba(100, 181, 246, 0.1);
        }

        .tab-btn.active {
            color: #64b5f6;
            border-bottom-color: #64b5f6;
            background: rgba(100, 181, 246, 0.1);
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #64b5f6;
            border-radius: 10px;
            padding: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .hero-card, .monster-card, .room-card, .treasure-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid #81c784;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .monster-card {
            border-color: #e57373;
        }

        .treasure-card {
            border-color: #ffb74d;
        }

        .room-card {
            border-color: #64b5f6;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }

        .card-title {
            font-weight: bold;
            font-size: 1.1em;
        }

        .card-badge {
            background: rgba(100, 181, 246, 0.2);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 8px;
            border-radius: 4px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.8em;
            color: #bdbdbd;
        }

        .stat-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #81c784;
        }

        .loot-list {
            margin-top: 10px;
        }

        .loot-item {
            background: rgba(255, 181, 77, 0.1);
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
        }

        .loot-name {
            color: #ffb74d;
        }

        .loot-value {
            color: #81c784;
        }

        .floor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .floor-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #64b5f6;
            border-radius: 10px;
            padding: 15px;
        }

        .room-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .mini-room {
            background: rgba(100, 181, 246, 0.1);
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            font-size: 0.8em;
        }

        .controls {
            margin-bottom: 20px;
            text-align: center;
        }

        button {
            background: #64b5f6;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            background: #42a5f5;
            transform: translateY(-2px);
        }

        .evolution-timeline {
            background: rgba(129, 199, 132, 0.1);
            border: 1px solid #81c784;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .timeline-item {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            border-left: 3px solid #81c784;
        }

        .search-box {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #64b5f6;
            border-radius: 5px;
            color: #e0e0e0;
        }

        .search-box::placeholder {
            color: #bdbdbd;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .run-summary {
                grid-template-columns: 1fr;
            }

            .floor-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÆ LosTribe Backstage Generator</h1>

        <div class="controls">
            <button onclick="generateNewRun()">üé≠ Generate New Run</button>
            <button onclick="toggleView('hero')">üë§ Hero</button>
            <button onclick="toggleView('dungeon')">üè∞ Dungeon</button>
            <button onclick="toggleView('encounters')">‚öîÔ∏è Encounters</button>
            <button onclick="toggleView('treasures')">üíé Treasures</button>
            <button onclick="toggleView('events')">üé≠ Events</button>
            <button onclick="toggleView('evolution')">üå± Evolution</button>
        </div>

        <div id="run-summary" class="run-summary">
            <div class="summary-card">
                <h3 id="hero-name">-</h3>
                <div>Hero</div>
            </div>
            <div class="summary-card">
                <h3 id="total-floors">-</h3>
                <div>Floors</div>
            </div>
            <div class="summary-card">
                <h3 id="total-rooms">-</h3>
                <div>Rooms</div>
            </div>
            <div class="summary-card">
                <h3 id="total-monsters">-</h3>
                <div>Monsters</div>
            </div>
            <div class="summary-card">
                <h3 id="total-treasures">-</h3>
                <div>Treasures</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('hero')">üë§ Hero Details</button>
            <button class="tab-btn" onclick="showTab('dungeon')">üè∞ Dungeon Layout</button>
            <button class="tab-btn" onclick="showTab('encounters')">‚öîÔ∏è All Encounters</button>
            <button class="tab-btn" onclick="showTab('treasures')">üíé All Treasures</button>
            <button class="tab-btn" onclick="showTab('events')">üé≠ All Events</button>
            <button class="tab-btn" onclick="showTab('evolution')">üå± Evolution Path</button>
        </div>

        <div id="hero-tab" class="tab-content active">
            <h2>üë§ Hero Details</h2>
            <div id="hero-details"></div>
        </div>

        <div id="dungeon-tab" class="tab-content">
            <h2>üè∞ Dungeon Layout</h2>
            <div id="dungeon-layout"></div>
        </div>

        <div id="encounters-tab" class="tab-content">
            <h2>‚öîÔ∏è All Encounters</h2>
            <input type="text" class="search-box" placeholder="Search encounters..." onkeyup="filterEncounters(this.value)">
            <div id="encounters-list"></div>
        </div>

        <div id="treasures-tab" class="tab-content">
            <h2>üíé All Treasures</h2>
            <input type="text" class="search-box" placeholder="Search treasures..." onkeyup="filterTreasures(this.value)">
            <div id="treasures-list"></div>
        </div>

        <div id="events-tab" class="tab-content">
            <h2>üé≠ All Events</h2>
            <div id="events-list"></div>
        </div>

        <div id="evolution-tab" class="tab-content">
            <h2>üå± Evolution Path</h2>
            <div id="evolution-timeline"></div>
        </div>
    </div>

    <script type="module">
        import { generateCompleteRun } from './src/backstage-generator.js';

        let currentRunData = null;

        window.generateNewRun = function() {
            console.log('üé≠ Generating new run...');
            currentRunData = generateCompleteRun({
                totalFloors: 7,
                seed: Math.floor(Math.random() * 1000000)
            });
            updateDisplay();
        };

        window.showTab = function(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        };

        window.toggleView = function(view) {
            const element = document.getElementById(view + '-details') || document.getElementById(view + '-list') || document.getElementById(view + '-layout') || document.getElementById(view + '-timeline');
            if (element) {
                element.classList.toggle('hidden');
            }
        };

        window.filterEncounters = function(query) {
            const encounters = document.querySelectorAll('#encounters-list .monster-card');
            encounters.forEach(card => {
                const name = card.querySelector('.card-title').textContent.toLowerCase();
                if (name.includes(query.toLowerCase())) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        };

        window.filterTreasures = function(query) {
            const treasures = document.querySelectorAll('#treasures-list .treasure-card');
            treasures.forEach(card => {
                const name = card.querySelector('.card-title').textContent.toLowerCase();
                if (name.includes(query.toLowerCase())) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        };

        function updateDisplay() {
            if (!currentRunData) return;

            // Update summary
            document.getElementById('hero-name').textContent = currentRunData.hero.name;
            document.getElementById('total-floors').textContent = currentRunData.dungeon.totalFloors;
            document.getElementById('total-rooms').textContent = currentRunData.dungeon.allRooms.length;
            document.getElementById('total-monsters').textContent = currentRunData.dungeon.allMonsters.length;
            document.getElementById('total-treasures').textContent = currentRunData.dungeon.allTreasures.length;

            // Update hero details
            updateHeroDetails();

            // Update dungeon layout
            updateDungeonLayout();

            // Update encounters
            updateEncounters();

            // Update treasures
            updateTreasures();

            // Update events
            updateEvents();

            // Update evolution
            updateEvolution();
        }

        function updateHeroDetails() {
            const hero = currentRunData.hero;
            const container = document.getElementById('hero-details');

            container.innerHTML = `
                <div class="hero-card">
                    <div class="card-header">
                        <span class="card-title">${hero.name} the ${hero.class}</span>
                        <span class="card-badge">Level ${hero.level}</span>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">HP</div>
                            <div class="stat-value">${hero.stats.hp}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Attack</div>
                            <div class="stat-value">${hero.stats.atk}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Defense</div>
                            <div class="stat-value">${hero.stats.def}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Speed</div>
                            <div class="stat-value">${hero.stats.spd}</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px;">
                        <strong>Elemental Affinity:</strong> ${hero.elementAffinity}<br>
                        <strong>Tarot Destiny:</strong> ${hero.tarotDestiny}<br>
                        <strong>Starting Deck:</strong> ${hero.startingDeck.length} cards<br>
                        <strong>Energy:</strong> ${hero.energy}/${hero.maxEnergy}
                    </div>
                </div>
            `;
        }

        function updateDungeonLayout() {
            const container = document.getElementById('dungeon-layout');
            const floors = currentRunData.dungeon.floors;

            container.innerHTML = `
                <div class="floor-grid">
                    ${floors.map(floor => `
                        <div class="floor-card">
                            <h3>Floor ${floor.level}</h3>
                            <div class="room-grid">
                                ${floor.rooms.map(room => `
                                    <div class="mini-room">
                                        <div><strong>${room.type}</strong></div>
                                        <div>${room.tarot}</div>
                                        <div>${room.monsters ? room.monsters.length : 0} monsters</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function updateEncounters() {
            const container = document.getElementById('encounters-list');
            const encounters = currentRunData.encounters;

            container.innerHTML = encounters.map(encounter => `
                <div class="monster-card">
                    <div class="card-header">
                        <span class="card-title">${encounter.monster.name}</span>
                        <span class="card-badge">${encounter.difficulty.toUpperCase()}</span>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">HP</div>
                            <div class="stat-value">${encounter.monster.stats.hp}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Attack</div>
                            <div class="stat-value">${encounter.monster.stats.atk}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Defense</div>
                            <div class="stat-value">${encounter.monster.stats.def}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Speed</div>
                            <div class="stat-value">${encounter.monster.stats.spd}</div>
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>Element:</strong> ${encounter.monster.element} |
                        <strong>Tarot:</strong> ${encounter.monster.tarot} |
                        <strong>Floor:</strong> ${encounter.floor}
                    </div>
                    ${encounter.potentialLoot.length > 0 ? `
                        <div class="loot-list">
                            <strong>Potential Loot:</strong>
                            ${encounter.potentialLoot.map(loot => `
                                <div class="loot-item">
                                    <span class="loot-name">${loot.type}</span>
                                    <span class="loot-value">${loot.amount || loot.description}</span>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function updateTreasures() {
            const container = document.getElementById('treasures-list');
            const treasures = currentRunData.treasures;

            container.innerHTML = treasures.map(treasure => `
                <div class="treasure-card">
                    <div class="card-header">
                        <span class="card-title">${treasure.type} Treasure</span>
                        <span class="card-badge">${treasure.rarity.toUpperCase()}</span>
                    </div>
                    <div><strong>Floor ${treasure.floor} - Value: ${treasure.value}g</strong></div>
                    <div class="loot-list">
                        ${treasure.contents.map(item => `
                            <div class="loot-item">
                                <span class="loot-name">${item.name || item.type}</span>
                                <span class="loot-value">${item.amount || item.description || ''}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function updateEvents() {
            const container = document.getElementById('events-list');
            const events = currentRunData.events;

            container.innerHTML = events.map(event => `
                <div class="room-card">
                    <div class="card-header">
                        <span class="card-title">Tarot Event: ${event.tarotCard}</span>
                        <span class="card-badge">Floor ${event.floor}</span>
                    </div>
                    <div><strong>Type:</strong> ${event.type}</div>
                    <div><strong>Choices:</strong></div>
                    <ul>
                        ${event.choices.map(choice => `<li>${choice.text} (${choice.effect})</li>`).join('')}
                    </ul>
                </div>
            `).join('');
        }

        function updateEvolution() {
            const container = document.getElementById('evolution-timeline');
            const evolution = currentRunData.evolution;

            container.innerHTML = `
                <div class="evolution-timeline">
                    <h3>Starting State</h3>
                    <div class="timeline-item">
                        <strong>Initial Stats:</strong> HP:${evolution.startingState.stats.hp} ATK:${evolution.startingState.stats.atk} DEF:${evolution.startingState.stats.def}
                    </div>

                    ${evolution.milestones.map(milestone => `
                        <div class="timeline-item">
                            <h4>Floor ${milestone.floor} - ${milestone.type}</h4>
                            <div>${milestone.description}</div>
                            <div><strong>Changes:</strong> ${milestone.potentialChanges.map(c => c.type).join(', ')}</div>
                        </div>
                    `).join('')}

                    <div class="timeline-item">
                        <h4>Final Evolution</h4>
                        <div>The hero's complete transformation journey through all floors</div>
                    </div>
                </div>
            `;
        }

        // Generate initial run
        generateNewRun();
    </script>
</body>
</html>
